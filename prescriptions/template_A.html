<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prescription Template</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap');

        /* --- Theme Variables Default (Overridden by Variants) --- */
        :root {
            --theme-color: #2e7d32;
            --theme-light: #e8f5e9;
            --header-bg: #fbfad2;
            --header-text: #2e7d32;
            --border-color: #d1d5db;
            --text-primary: #111827;
            --text-secondary: #4b5563;
        }

        /* --- 10 Professional Variants --- */

        /* Variant 1: Classic Medical Blue & Cream (Trusted, Traditional) */
        .variant-1 {
            --theme-color: #1565c0;
            --theme-light: #e3f2fd;
            --header-bg: #fff9c4;
            --header-text: #0d47a1;
        }

        /* Variant 2: Forest Green & Mint (Nature, Healing) */
        .variant-2 {
            --theme-color: #2e7d32;
            --theme-light: #e8f5e9;
            --header-bg: #f1f8e9;
            --header-text: #1b5e20;
        }

        /* Variant 3: Teal & Clean White (Modern, Surgical) */
        .variant-3 {
            --theme-color: #00897b;
            --theme-light: #e0f2f1;
            --header-bg: #ffffff;
            --header-text: #00695c;
            --border-color: #b2dfdb;
        }

        /* Variant 4: Navy Blue & Minimalist White (Corporate, Serious) */
        .variant-4 {
            --theme-color: #283593;
            --theme-light: #e8eaf6;
            --header-bg: #ffffff;
            --header-text: #1a237e;
        }

        /* Variant 5: Deep Maroon & Linen (Premium, Specialist) */
        .variant-5 {
            --theme-color: #c62828;
            --theme-light: #ffebee;
            --header-bg: #fafafa;
            --header-text: #b71c1c;
        }

        /* Variant 6: Slate Grey & White (Neutral, Diagnostic) */
        .variant-6 {
            --theme-color: #455a64;
            --theme-light: #eceff1;
            --header-bg: #ffffff;
            --header-text: #263238;
        }

        /* Variant 7: Royal Purple & Lavender (Soft, Pediatric/Derma) */
        .variant-7 {
            --theme-color: #6a1b9a;
            --theme-light: #f3e5f5;
            --header-bg: #ffffff;
            --header-text: #4a148c;
        }

        /* Variant 8: Indigo & Pale Yellow (High Contrast, Readable) */
        .variant-8 {
            --theme-color: #3f51b5;
            --theme-light: #e8eaf6;
            --header-bg: #fffde7;
            --header-text: #283593;
        }

        /* Variant 9: Olive & Beige (Natural, Holistic) */
        .variant-9 {
            --theme-color: #558b2f;
            --theme-light: #f1f8e9;
            --header-bg: #fff8e1;
            --header-text: #33691e;
        }

        /* Variant 10: Charcoal & Blue-Grey (Tech, Modern) */
        .variant-10 {
            --theme-color: #37474f;
            --theme-light: #cfd8dc;
            --header-bg: #eceff1;
            --header-text: #263238;
        }

        /* --- Base Reset --- */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background-color: #e5e7eb;
            font-family: 'Inter', 'Noto Sans Bengali', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: var(--text-primary);
        }

        /* --- Page Layout (A4) --- */
        .page {
            width: 794px;
            height: 1050px;
            position: relative;
            background: white;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin-bottom: 24px;
        }

        /* --- Header --- */
        .header {
            background-color: var(--header-bg);
            padding: 24px 40px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            border-bottom: 3px solid var(--theme-color);
        }

        .doc-info-left {
            width: 50%;
        }

        .doc-info-right {
            width: 50%;
            text-align: right;
        }

        .doc-name-bn {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 4px;
            color: var(--header-text);
        }

        .doc-name-en {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
            text-transform: uppercase;
            color: var(--header-text);
        }

        .degrees-bn,
        .degrees-en,
        .affiliation-bn,
        .affiliation-en {
            font-size: 11px;
            line-height: 1.5;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .specialty-text {
            margin-top: 12px;
            font-size: 11px;
            font-weight: 600;
            color: var(--theme-color);
            background: rgba(255, 255, 255, 0.5);
            padding: 4px 8px;
            border-radius: 4px;
            display: inline-block;
        }

        /* --- Patient Info Strip --- */
        .patient-info {
            background-color: white;
            border-bottom: 1px solid var(--border-color);
            padding: 10px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* --- Main Body Layout --- */
        .main-body {
            flex-grow: 1;
            display: flex;
            position: relative;
        }

        /* --- Left Sidebar --- */
        .sidebar {
            width: 32%;
            border-right: 1px solid var(--border-color);
            padding: 24px 16px 24px 40px;
            background-color: #fafafa;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .field-group {
            width: 100%;
        }

        .field-label {
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--theme-color);
            margin-bottom: 6px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 2px;
            display: inline-block;
            width: 100%;
        }

        .field-value {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.4;
            white-space: pre-line;
        }

        .vitals-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 4px;
        }

        .vital-item {
            font-size: 12px;
            display: flex;
            justify-content: space-between;
        }

        .vital-key {
            font-weight: 600;
            color: var(--text-secondary);
        }

        .vital-val {
            font-weight: 500;
            color: var(--text-primary);
        }

        /* Suggested Tests Section Highlight */
        .suggested-tests-box {
            background-color: var(--theme-light);
            padding: 10px;
            border-radius: 4px;
            border-left: 3px solid var(--theme-color);
        }

        .suggested-tests-box .field-label {
            background: none;
            border: none;
            padding: 0;
            margin-bottom: 4px;
            color: var(--theme-color);
        }

        /* --- Rx Area --- */
        .rx-area {
            width: 68%;
            padding: 24px 40px;
            position: relative;
        }

        .rx-header {
            display: flex;
            align-items: flex-end;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--theme-light);
            padding-bottom: 10px;
        }

        .rx-symbol {
            font-family: 'Times New Roman', serif;
            font-size: 48px;
            font-weight: 700;
            color: var(--theme-color);
            line-height: 0.8;
            margin-right: 10px;
        }

        /* Medicine Table */
        .med-table {
            width: 100%;
            border-collapse: collapse;
        }

        .med-table tr {
            border-bottom: 1px dashed #f0f0f0;
        }

        .med-table td {
            vertical-align: top;
            padding: 12px 4px;
            font-size: 13px;
        }

        .col-idx {
            width: 30px;
            font-weight: 700;
            color: var(--text-secondary);
        }

        .col-name {
            width: 45%;
            font-weight: 700;
            color: var(--text-primary);
            font-size: 14px;
        }

        .col-dose {
            width: 20%;
            font-weight: 600;
            color: var(--text-primary);
        }

        .col-duration {
            width: 15%;
            color: var(--text-secondary);
        }

        .col-instruction {
            font-style: italic;
            color: var(--text-secondary);
            font-size: 12px;
            display: block;
            margin-top: 2px;
        }

        /* Watermark */
        .watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 350px;
            opacity: 0.04;
            pointer-events: none;
            z-index: 0;
        }

        .next-visit {
            position: absolute;
            bottom: 30px;
            right: 40px;
            background: var(--theme-light);
            color: var(--theme-color);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 13px;
        }

        /* --- Footer --- */
        .footer {
            height: 90px;
            display: flex;
            border-top: 4px solid var(--theme-color);
        }

        .footer-left {
            width: 65%;
            background-color: #ffffff;
            padding: 10px 40px;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .logo-box {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-box img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .hospital-info h2 {
            font-size: 18px;
            font-weight: 700;
            color: var(--theme-color);
            line-height: 1.2;
        }

        .hospital-info p {
            font-size: 10px;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        .footer-right {
            width: 35%;
            background-color: var(--theme-light);
            padding: 10px 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .footer-right h3 {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .footer-right p {
            font-size: 13px;
            font-weight: 700;
            color: var(--theme-color);
        }

        /* Print Settings */
        @media print {
            body {
                background: none;
                padding: 0;
            }

            .page {
                width: 100%;
                height: 100vh;
                box-shadow: none;
                margin: 0;
                page-break-after: always;
            }

            .page:last-child {
                page-break-after: auto;
            }

            /* Force background colors */
            .sidebar {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            .header {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            .suggested-tests-box {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
        }
    </style>
</head>

<body>

    {{#each pages}}
    <!-- The variant class is applied here dynamically -->
    <div class="page {{@root.template.variant}}">

        <!-- Header -->
        <div class="header">
            <div class="doc-info-left">
                <div class="doc-name-bn">{{@root.doctor.name_bn}}</div>
                <div class="degrees-bn">{{{@root.doctor.degrees_bn}}}</div>
                <div class="affiliation-bn">
                    <div>{{@root.doctor.affiliation1_bn}}</div>
                    <div>{{@root.doctor.affiliation2_bn}}</div>
                </div>
                <div class="specialty-text">{{{@root.doctor.specialty_text}}}</div>
            </div>

            <div class="doc-info-right">
                <div class="doc-name-en">{{@root.doctor.name_en}}</div>
                <div class="degrees-en">{{{@root.doctor.degrees_en}}}</div>
                <div class="affiliation-en">
                    <div>{{@root.doctor.affiliation1_en}}</div>
                    <div>{{@root.doctor.affiliation2_en}}</div>
                </div>
            </div>
        </div>

        <!-- Patient Info -->
        <div class="patient-info">
            <div style="flex: 2;">Name: {{@root.patient.name}}</div>
            <div style="flex: 1;">Age: {{@root.patient.age}}</div>
            <div style="flex: 1; text-align: right;">Date: {{@root.date}}</div>
        </div>

        <div class="main-body">
            <!-- Sidebar -->
            <div class="sidebar">
                <div class="field-group">
                    <span class="field-label">Chief Complaint (C/C)</span>
                    <div class="field-value">{{@root.patient.cc}}</div>
                </div>

                <div class="field-group">
                    <span class="field-label">History</span>
                    <div class="field-value">
                        {{@root.patient.known_case}}<br>
                        {{@root.patient.family_history}}
                    </div>
                </div>

                <div class="field-group">
                    <span class="field-label">On Examination (O/E)</span>
                    <div class="vitals-grid">
                        <div class="vital-item"><span class="vital-key">BP:</span> <span
                                class="vital-val">{{@root.patient.bp}}</span></div>
                        <div class="vital-item"><span class="vital-key">Pulse:</span> <span
                                class="vital-val">{{@root.patient.pulse}}</span></div>
                        <div class="vital-item"><span class="vital-key">Temp:</span> <span
                                class="vital-val">{{@root.patient.temp}}</span></div>
                        <div class="vital-item"><span class="vital-key">Anemia:</span> <span
                                class="vital-val">{{@root.patient.anemia}}</span></div>
                        <div class="vital-item"><span class="vital-key">Jaundice:</span> <span
                                class="vital-val">{{@root.patient.jaundice}}</span></div>
                        <div class="vital-item"><span class="vital-key">Heart:</span> <span
                                class="vital-val">{{@root.patient.heart}}</span></div>
                        <div class="vital-item"><span class="vital-key">Lungs:</span> <span
                                class="vital-val">{{@root.patient.lungs}}</span></div>
                    </div>
                </div>

                <!-- Suggested Tests Section -->
                {{#if @root.patient.suggested_tests}}
                <div class="suggested-tests-box">
                    <span class="field-label">Suggested Tests</span>
                    <div class="field-value" style="font-weight: 500;">
                        {{@root.patient.suggested_tests}}
                    </div>
                </div>
                {{/if}}
            </div>

            <!-- Rx Area -->
            <div class="rx-area">
                <div class="rx-header">
                    <span class="rx-symbol">Rx</span>
                </div>

                <!-- Watermark -->
                <div class="watermark">
                    <svg viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M60 20 Q 60 10 70 10" stroke="currentColor" stroke-width="4" stroke-linecap="round"
                            style="color: var(--theme-color)" />
                        <path d="M140 20 Q 140 10 130 10" stroke="currentColor" stroke-width="4" stroke-linecap="round"
                            style="color: var(--theme-color)" />
                        <circle cx="70" cy="10" r="4" fill="currentColor" style="color: var(--theme-color)" />
                        <circle cx="130" cy="10" r="4" fill="currentColor" style="color: var(--theme-color)" />
                        <path d="M60 20 L 60 80 Q 60 140 100 140 Q 140 140 140 80 L 140 20" stroke="currentColor"
                            stroke-width="3" fill="none" style="color: var(--theme-color)" />
                        <path d="M100 140 L 100 160 Q 100 190 70 170" stroke="currentColor" stroke-width="3" fill="none"
                            style="color: var(--theme-color)" />
                        <circle cx="65" cy="165" r="15" stroke="currentColor" stroke-width="3" fill="none"
                            style="color: var(--theme-color)" />
                        <circle cx="65" cy="165" r="5" fill="currentColor" style="color: var(--theme-color)" />
                    </svg>
                </div>

                <!-- Medicine Table -->
                <table class="med-table">
                    {{#each medicines}}
                    <tr>
                        <td class="col-idx">{{this.index}}.</td>
                        <td class="col-name">
                            {{this.name}}
                            <span class="col-instruction">{{this.instruction}}</span>
                        </td>
                        <td class="col-dose">{{this.dosage}}</td>
                        <td class="col-duration">{{this.duration}}</td>
                    </tr>
                    {{/each}}
                </table>

                <div class="next-visit">
                    Next Visit: {{@root.next_visit_duration}}
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="footer-left">
                {{#if @root.chember.logo_url}}
                <div class="logo-box">
                    <img src="{{@root.chember.logo_url}}" alt="Hospital Logo">
                </div>
                {{/if}}
                <div class="hospital-info">
                    <h2>{{@root.chember.name}}</h2>
                    <p>{{@root.chember.tagline}}</p>
                    <p>{{@root.chember.address}}</p>
                    <p>Mobile: {{@root.chember.mobile}}</p>
                </div>
            </div>
            <div class="footer-right">
                <h3>Visiting Hours</h3>
                <p>{{@root.chember.visiting_hour}}</p>
            </div>
        </div>
    </div>
    {{/each}}

</body>

</html>